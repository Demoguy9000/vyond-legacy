<html>
	<head>
		<title>Video Editor</title>
		<link rel="stylesheet" type="text/css" href="http://localhost:4343/pages/css/modern-normalize.css">
		<link rel="stylesheet" type="text/css" href="http://localhost:4343/pages/css/global.css">
		<link rel="stylesheet" type="text/css" href="http://localhost:4343/pages/css/flash.css">
		<link rel="stylesheet" type="text/css" href="http://localhost:4343/pages/css/importer.css">
		<style>
			#importer-files {
				display: none
			}
		</style>
		<script src="http://localhost:4343/pages/js/jquery.js"></script>
		<script src="http://localhost:4343/pages/js/filesize.js"></script>
		<script src="http://localhost:4343/pages/js/global.js"></script>
		<script>
			// some of this code was taken from regularspark. but it works here lol :)
			const params = new Proxy(new URLSearchParams(window.location.search), {
				get: (searchParams, prop) => searchParams.get(prop),
			});
			let themePicker = params.tray;
			let apiServer = params.api || "http://localhost:4343";
			var theme;
			switch (themePicker) {
				case "":
				case "null":
				case "undefined": {
					theme = 'retro';
					break;
				} case "family": {
					theme = 'custom';
					break;
				} default: theme = themePicker;
			}
			let flashvars = new URLSearchParams({
				appCode: "go",
				ctc: "go",
				isEmbed: 1,
				isLogin: "Y",
				username:"Jerry",
				uemail:"jerryguy69420@gmail.com",
				nextUrl: "javascript:exitStudio()",
				tray: theme,
				movieId: params.movieId || "",
				userId:  2292,
				isWide: 0,
				page: "",
				siteId: "go",
				tlang: "en_US",
				ut: 40,
				lid: 7,
				apiserver: "http://localhost:4343/",
				storePath: "http://localhost:4343/static/store/<store>",
				clientThemePath: `http://localhost:4343/${params.staticVer || "477"}/<client_theme>`
			}).toString();
			if (
				params.v == "414827163ad4eb60" || params.v == "857" || params.v == "808" || params.v == "810" || params.v == "930" || params.v == "2013" 
				|| params.v == "877" || params.v == "503"
			) flashvars = new URLSearchParams({
				appCode: "go",
				collab: 0,
				ctc: "go",
				goteam_draft_only: 1,
				isLogin: "Y",
				isWide: 0,
				lid: 7,
				nextUrl: "javascript:exitStudio()",
				movieId: params.movieId || "",
				page: "",
				retut: 1,
				// loads community library on newer lvms
				siteId: "11",
				tray: params.tray || "custom",
				tlang: "en_US",
				ut: 60,
				apiserver: "http://localhost:4343/",
				storePath: "http://localhost:4343/static/store/<store>",
				aniVer: params.v,
				clientThemePath: `http://localhost:4343/${params.staticVer || "477"}/<client_theme>`
			}).toString();
		</script>
	</head>
	<body style="margin:0px">
		<main>
			<nav id="importer">
				<nav id="import_head">
					<button id="import-toggle" onclick="document.getElementById('importer-files').click()" class="import-button">UPLOAD FILES</button>
					<h3 class="close-button" onclick="hideImporter()">✖</h3>
					<form>
						<input id="importer-files" type="file" name="file" title="Upload Files" accept=".mp3,.wav,.ogg,.wma,.swf,.gif,.png,.jpg,.mp4"/>
					</form>
				</nav>
				<div id="importer-queue"></div>
			</nav>
			<script>document.write(`<object data="http://localhost:4343/animation/${params.v}/${params.type || "go"}_full.swf" type="application/x-shockwave-flash" id="Studio" width="100%" height="100%"><param name="align" value="middle"><param name="allowScriptAccess" value="always"><param name="allowFullScreen" value="true"><param name="wmode" value="window"><param name="flashvars" value="${flashvars}"><param name="movie" value="http://localhost:4343/animation/${params.v}/${params.type || "go"}_full.swf"></object>`)</script>
		</main><script>document.write(`
		<div id="previewer" style="display:none">
			<div id="preview-inside">
				<h2 id="preview-video">Preview Video</h2>
			
				<object id="preview_player" data="http://localhost:4343/animation/${params.v}/player.swf" type="application/x-shockwave-flash"
					width="640" height="360">
					<param name="flashvars" />
					<param name="allowScriptAccess" value="always" />
					<param name="allowFullScreen" value="true" />
				</object>
				<div class="buttons">
					<button class="preview-button edit" type="button" onclick="hidePreviewer();">Back to editing</button>
					<button class="preview-button save" type="button" onclick="publishStudio();">Save Now</button>
				</div>

				<a class="close-button" onclick="hidePreviewer()">×</a>
			</div>
		</div>`)</script>
	</body>
	<script src="http://localhost:4343/pages/js/importer.js"></script>
	<script src="http://localhost:4343/pages/js/studio.js"></script>
</html>
